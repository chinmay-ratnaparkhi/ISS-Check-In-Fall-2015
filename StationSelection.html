<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<link href="css/bootstrap.css" rel="stylesheet"></link>
	<link href="css/intensive-styling.css" rel="stylesheet"></link>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	<script src="js/bootstrap.js"></script>
    <title>Document Selection</title>
  <script>
  $(function() {
			$( "#final_list" ).draggable();
	});
	var my_documents= new Array();
	var original_background= '#E0ECF8';
	var hover_background= '#A9D0F5';
	var selected_background= '#FBEFF5';
	var i20p;
	var ds2019p;
	var phonep;
	var passp;
	var visap;
	var i94p;
	var i797p;
	var error_message='';
	
/* ======================================== GENERAL FUNCTIONS =================================================== */
	
	function update_indices(){
		i20p= my_documents.indexOf('i20');
		ds2019p= my_documents.indexOf('ds2019');
		phonep= my_documents.indexOf('phone');
		passp= my_documents.indexOf('passport');
		visap= my_documents.indexOf('visa');
		i94p= my_documents.indexOf('i94');
		i797p= my_documents.indexOf('statchange');
	}
	
/* ======================================== NAVBAR FUNCTIONS =================================================== */
	/* Clear all cookies, unselect everything and restart from cat_select  */
	function clearAll_Restart(){
		$('#reset_confirmation').modal('show');
	}
	
	function perform_exit(){
		cleanAllCookies();
		document.write('Deleting current data and restarting.');
		setTimeout(function(){
						window.location='selectStudentCategory.html';
					}, 2000);
	}	
	
/* ======================================== ARRAY FUNCTIONS =================================================== */	
	// On Click decision --> add or remove
	function doc_clicked(clicked_document){
		var test_index= my_documents.indexOf(clicked_document);					
		if(test_index > -1) remove_document(clicked_document);		
		else add_document(clicked_document);
	}
	
	// Add document
	function add_document(clicked_document){
		// Document Blocking 
		if(clicked_document== 'i20'){
			$('#ds2019').addClass('off');
			$('#phone').addClass('off');
		}
		if(clicked_document== 'ds2019' || clicked_document== 'phone'){
			$('#i20').addClass('off');
		}
		
		var grabber= document.getElementById(clicked_document);
		$(grabber).addClass('on');
		grabber.innerHTML= '<span class="glyphicon glyphicon-check"></span>'+grabber.innerHTML;
		my_documents.push(clicked_document);
		get_dependents(clicked_document);
		
		publish();
	}
	
	// Add dependent documents
	function get_dependents(clicked_document){
		update_indices();
		
		if(clicked_document== 'passport' || clicked_document== 'i20' || clicked_document== 'ds2019'){
			if(visap== -1){
				var grabber= document.getElementById('visa');
					$(grabber).addClass('on');
					grabber.innerHTML= '<span class="glyphicon glyphicon-check"></span>'+grabber.innerHTML;
					my_documents.push('visa');
			}
			if(i94p== -1){
				grabber= document.getElementById('i94');
					$(grabber).addClass('on');
					grabber.innerHTML= '<span class="glyphicon glyphicon-check"></span>'+grabber.innerHTML;
					my_documents.push('i94');
			}
		}
	
	}
	
	// Remove document
	function remove_document(clicked_document){
		update_indices();
		
		// Changes in Clicked Tile
		var grabber= document.getElementById(clicked_document);
		grabber.innerHTML = grabber.innerHTML.replace('glyphicon glyphicon-check', '');
		$(grabber).removeClass('on');
		
		// Unblocking Documents
		if(clicked_document== 'i20') $('.off').removeClass('off'); 
		if(clicked_document == 'ds2019' && phonep == -1) $('.off').removeClass('off');
		if(clicked_document == 'phone' && ds2019p == -1) $('.off').removeClass('off');
		
		// Changes in the array
		var index_toBeRemoved= my_documents.indexOf(clicked_document);
			if(index_toBeRemoved > -1) my_documents.splice(index_toBeRemoved, 1);
			
		publish();
	}

/* ======================================== BOTTOM BUTTON FUNCTIONS =================================================== */
	function reset(){
		for(var every_document in my_documents){
			var grabber= document.getElementById(my_documents[every_document]);
			grabber.innerHTML = grabber.innerHTML.replace('glyphicon glyphicon-check', '');
		}
		
		$('.off').removeClass('off');
		$('.on').removeClass('on'); 
		my_documents=[];
		error_message= '';
		publish();
	}
	
	function Next(){
		var continuation_flag = validate_selections();
		if(!continuation_flag){
			document.getElementById('print_error').innerHTML= error_message;
			$('#error_report').modal('show');
			error_message='';
		}else{
			for(var i=0; i<my_documents.length; i++){
				setCookie(my_documents[i],'pending');
			}
		}
		
	}
	
/* ======================================== VALIDATIONS =================================================== */	
	function validate_selections(){
		update_indices();
		if(passp > -1 && i797p == -1)
		{
			if(visap == -1 || i94p == -1){
				error_message= 'If you need to upload your Passport, you must select Visa and I-94.';
				return false;
			}
			
			if(i20p == -1 && ds2019p == -1){
				error_message= 'If you need to upload your Passport, you must select I-20 or DS-2019.';
				return false;
			}
		}
		
		if(i20p > -1 || ds2019p > -1)
		{
			if(visap == -1 || i94p == -1){
				error_message= 'If you need to upload your I-20 or DS-2019, you must select Visa and I-94.';
				return false;
			}
		}
		
		if(visap > -1)
		{
			if(i94p == -1){
				error_message= 'If you need to upload your Visa, you must select I-94.';
				return false;
			}
		}
	
	
	}
	
/* ======================================== Preset Combinations =================================================== */	
	function f1f2_intensive(){
		reset();
			$('#ds2019').addClass('off');
			$('#phone').addClass('off');
			var doc_set = ["passport", "visa", "i94", "i20", "contacts", "address"];
			perform_preset(doc_set);
	}
	
	function j1j2_intensive(){
		reset();
			$('#i20').addClass('off');
			var doc_set = ["passport", "visa", "i94", "ds2019", "contacts", "address"];
			perform_preset(doc_set);
	}
	
	function other_intensive(){
		reset();
			var doc_set = ["passport", "visa", "i94", "statchange", "contacts", "address"];
			perform_preset(doc_set);
	}
	
	function express_i94(){
		reset();
			var doc_set = ["i94"];
			perform_preset(doc_set);
	}
	
	function express_contact(){
		reset();
			var doc_set = ["contacts", "address"];
			perform_preset(doc_set);
	}
	
	function i94contact(){
		reset();
			var doc_set = ["contacts", "address", "i94"];
			perform_preset(doc_set);
	}
	function perform_preset(doc_set){
		for(var i=0; i<doc_set.length; i++){
				var grabber= document.getElementById(doc_set[i]);
						$(grabber).addClass('on');
						grabber.innerHTML= '<span class="glyphicon glyphicon-check"></span>'+grabber.innerHTML;
						my_documents.push(doc_set[i]);
			}
		
		publish();
	}
	
	
/* ======================================== COOKIE FUNCTIONS =================================================== */
	// Set A cookie --> @arg : name and value
	function setCookie(cname,cvalue) {
		var d = new Date();
		d.setTime(d.getTime() + (24*60*60*1000));
		document.cookie = cname+"="+cvalue+"; "+"expires=" + d.toGMTString();
	}
	
	// Get A cookie --> @arg : name
	function getCookie(cname) {
		var name = cname + '=';
		var ca = document.cookie.split(';');
		for(var i=0; i<ca.length; i++) {
			var c = ca[i];
			while (c.charAt(0)==' ') c = c.substring(1);
			if (c.indexOf(name) == 0) {
				return c.substring(name.length, c.length);
			}
		}
		return '';
	}

	// Clean all cookies --> @arg : none
	function cleanAllCookies(){   
		var cookies = document.cookie.split(";");
		for (var i = 0; i < cookies.length; i++){   
			var spcook =  cookies[i].split("=");
			deleteCookie(spcook[0]);
		}
		function deleteCookie(cookiename){
			var d = new Date();
			d.setDate(d.getDate() - 1);
			var expires = ";expires="+d;
			var name=cookiename;
			//alert(name);
			var value="";
			document.cookie = name + "=" + value + expires + "; path=/acc/html";                    
		}
	}


/* ======================================== PUBLISHER FUNCTION =================================================== */

function publish(){
	var print_canvas = document.getElementById('final_list');
	if(my_documents.length >= 1){
		print_canvas.innerHTML= '<a href="#" class="list-group-item active" style="background:#F5EFFB;color:#000000;border-color: #ECE0F8;"><span class="glyphicon glyphicon-shopping-cart"></span>&nbsp;Selected Documents</a>';	
		for(var index in my_documents){
			print_canvas.innerHTML+= '<a href="#" class="list-group-item">'+readable(my_documents[index])+'</a>';	
		}
	}else{
			print_canvas.innerHTML= '';	
	}
	
	function readable(string) {
		return string.charAt(0).toUpperCase() + string.slice(1);
	}

}









	
  </script>
  </head>
  <style>

  </style>
  <body>
  
  
<!---- ======================================== NAVBAR BEGINS =============================================================== ---------->  
<nav class="navbar navbar-default">
  <div class="container-fluid">
   
	
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	  
	  <ul class="nav navbar-nav">
        <li class="active"><a href="#">Checklist</a></li>
		<li><a href="#">Back</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Options<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li onClick='f1f2_intensive()'><a href="#">F-1/F-2 Intensive</a></li>
            <li onClick='j1j2_intensive()'><a href="#">J-1/J-2 Intensive</a></li>
            <li onClick='other_intensive()'><a href="#">Other Intensive</a></li>
            <li class="divider"></li>
			 <li onClick='i94contact()'><a href="#">I-94, Address, Contact</a></li>
            <li class="divider"></li>
            <li onClick='express_i94()'><a href="#">Express Check In (I-94)</a></li>
			 <li onClick='express_contact()'><a href="#">Express Check In (Contact & address)</a></li>
			 <li class="divider"></li>
            <li onClick='reset()'><a href="#">Custom</a></li>
          </ul>
        </li>
      </ul>
	  
	  
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Administrative <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
				<li><a href="#" onClick='clearAll_Restart()'>Restart</a></li>
				
				<li><a href="#">Another action</a></li>
				<li><a href="#">Something else here</a></li>
				<li class="divider"></li>
				<li><a href="http://iss.ku.edu" target="_blank">ISS Website</a></li>
          </ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<!---- ======================================== NAVBAR ENDS =============================================================== ---------->


<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Brand</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Link <span class="sr-only">(current)</span></a></li>
        <li><a href="#">Link</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#">Action</a></li>
            <li><a href="#">Another action</a></li>
            <li><a href="#">Something else here</a></li>
            <li class="divider"></li>
            <li><a href="#">Separated link</a></li>
            <li class="divider"></li>
            <li><a href="#">One more separated link</a></li>
          </ul>
        </li>
      </ul>
      <form class="navbar-form navbar-left" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#">Link</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#">Action</a></li>
            <li><a href="#">Another action</a></li>
            <li><a href="#">Something else here</a></li>
            <li class="divider"></li>
            <li><a href="#">Separated link</a></li>
          </ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>



<!--=====================================================================================================================================-->
<!------ Reset Confirmation ----->
<div class="modal fade" id="reset_confirmation" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
		<div class="modal-body">
		   <h1>Reset?</h1>
		   <hr>
		   <p class="lead">Are you sure that you want to <strong>reset and restart</strong>?</p>
		</div>
		<div class="modal-footer">
		<center>
			<button type="button" class="btn btn-success" data-dismiss="modal" onClick="perform_exit();">Yes</button>
			<button type="button" class="btn btn-danger" data-dismiss="modal">&nbsp;No&nbsp;</button>
		</center>
	  </div>
	  </div>
    </div>
  </div>
</div>
<!--=====================================================================================================================================-->
<!------ ERROR REPORTING ----->
<div class="modal fade" id="error_report" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
		<div class="modal-body">
		   <h1>Error</h1>
		   <hr>
		   <p class="lead" id='print_error'></p>
		</div>
		<div class="modal-footer">
		<center>
			<button type="button" class="btn btn-danger" data-dismiss="modal">&nbsp;Alright&nbsp;</button>
		</center>
	  </div>
	  </div>
    </div>
  </div>
</div>
<!--=====================================================================================================================================-->
	<div class="container" >
			<div class="instruction_box">
				<p class="lead">Please look at your <strong><span style="background:#FE2E64;">&nbsp;Pink Checklist&nbsp;</span></strong> and select the forms that you need to submit.</p>
			</div>
			<p>&nbsp;</p>
			<div class="row" id='error_container'></div>
		<div class="row">
			<div class="col-lg-1"></div>
			<div class="col-lg-10">
				<div class="document-container">
						<ul class="document-tile">
								<li onClick='doc_clicked(this.id)' id='i20'>
								  <h3>I-20</h3>
								</li>
							  
							   <li onClick='doc_clicked(this.id)' id='ds2019'>
								  <h3>DS-2019</h3>
								</li>
								
								 <li onClick='doc_clicked(this.id)' id='phone'>
								  <h3>Phone Number</h3>
								</li>
								
								<li onClick='doc_clicked(this.id)' id='orientation'>
								  <h3>Orientation</h3>
								</li>
								
								<li onClick='doc_clicked(this.id)' id='passport'>
								  <h3>Passport</h3>
								</li>
							  
								<li onClick='doc_clicked(this.id)' id='visa'>
								  <h3>Visa</h3>
								</li>
							  
								<li onClick='doc_clicked(this.id)' id='i94'>
								  <h3>I-94</h3>
								</li>
								
								<li onClick='doc_clicked(this.id)' id='statchange'>
								  <h3>I-797</h3>
								</li>
							  
							   <li onClick='doc_clicked(this.id)' id='contacts'>
								  <h3>Emergency Contacts</h3>
								</li>
								
								<li onClick='doc_clicked(this.id)' id='address'>
								  <h3>Local Address</h3>
								</li> 
						</ul>
					</div>
					<div class="col-lg-1"></div>
			</div>
				<div class="sidebar-offcanvas"  style="position:absolute;width:150px;right:10px;">
				  <div class="list-group" id="final_list">
				  </div>
				</div>
			</div>
		</div>
		<p>&nbsp;</p>
		<center>
			<a class="btn btn-default btn-lg" onClick='reset()'>Reset</a>
			<a class="btn btn-success btn-lg" onClick='Next()'>Submit</a><br/>
		</center>
	</div>	
  </body>
</html>